# 32.4 高效注释之关键(Key to Effective Comments)

#目录：

![](https://ws2.sinaimg.cn/large/006tKfTcgy1fhn1zpfxamj30ec0kwtap.jpg)

---

###关于注释的3个例子：

- 注释不对的例子
![](https://ws2.sinaimg.cn/large/006tKfTcgy1fhmdix0rlkj30m608i76m.jpg)

- 注释只是重复代码而毫无价值的例子
![](https://ws4.sinaimg.cn/large/006tKfTcgy1fhmdj1a00aj30j8082dhp.jpg)

- 注释真正有用的例子
![](https://ws1.sinaimg.cn/large/006tKfTcgy1fhmdj71l4oj30so05kq4w.jpg)

**拙劣的注释还不如没有好**，前两个例子就是这样。

下面将说明高效注释的关键。

---

##6种注释种类：

###1.重复代码：
重复性注释只是用不同文字把代码的工作又描述了一次。

除了给读者增加阅读量外，没有提供更多信息。

###2.解释代码：
解释性注释通常用于复杂、有巧、敏感的代码块。

如果代码过于复杂而需要解释，最好是改进代码，而不是添加注释。

使代码清晰后再用概述性注释或者意图性注释。

###3.代码标记：

标志性并非有意留在代码中，它提醒开发者某处的工作没做完。

在注释中放入特定的字符串，便于下次搜索到它们。

很有必要规范标记型注释的风格，统一为特定的标记风格后，就可以将机器搜索不完整代码段的操作作为发布前检查清单的步骤之一。

###4.概述代码：
概述性代码：将若干行代码的意思以一两句话说出来。

好处：**可读性强**。


###5.代码意图说明：

目的性注释用来指明一段**代码的意图**，指出要解决的问题，而非解决的方法。

###6.传达代码无法表述的信息：

某些信息不能通过代码来表达，但又必须包含在源代码中。
这种注释包括；

- 杂项信息
 - 版权声明
 - 保密要求
 - 版本号
- 与代码设计有关的注意事项
- 相关要求或架构文件的索引
- 联机参考链接
- 优化注记 
- xx编辑器要求有的注释

###完工后，允许那些注释留下？

- 传达代码无法表述的信息
- 目的性概述
- 概括性概述

---

##高效注释：

高效注释并不费时。
注释太多并不比注释太少好，要找折中点。

注释占用太多时间的原因：

- 注释的风格不易修改
- 不知道程序真正的作用

写注释所占用的时间其实都是用在了**更好地理解程序**上面。


###高效注释的指导原则：

####采用不会打断或抑制修改的注释风格：

- 不易维护的注释风格：

![](https://ws2.sinaimg.cn/large/006tKfTcgy1fhmynctk14j30vy0aon1c.jpg)

![](https://ws4.sinaimg.cn/large/006tKfTcgy1fhmynsoesyj30w009cn18.jpg)
![](https://ws2.sinaimg.cn/large/006tKfTcgy1fhmyoerjvbj30lc070jt8.jpg)

- 易维护的注释风格：
![](https://ws1.sinaimg.cn/large/006tKfTcgy1fhmyo8yga8j30w009itcw.jpg)



####用伪代码编程法减少注释时间:

加入写代码前以注释先勾勒出代码，在写完程序的同时，注释也就写好了。

由于在填充**低层次**的编程语言代码前，就已写出**高层次的伪代码**，因而可以获得所有设计方面的好处。

不要事后再写注释，因为你还得回忆或思考某行代码干什么，不能像边编程边注释那样把正在考虑的内容写下来。

由于容易忘掉设计中的假设或细节问题，写出来的注释也不够准确。

如果你的设计很难进行编程，请在你担忧**注释**或**代码**之前先着手去**简化设计**。

若你用**伪代码**理清自己的思路，编程就容易多了，**注释**也自然而然就做好了。


####性能不是逃避注释的好借口:

早期，在其中加入注释会付出**性能下降**的代价。

- 20世纪80年代的早期IBM PC里，Basic程序中的注释会让程序跑慢
- 90年代的asp页面
- 21世纪初，JavaScript等需要通过网络连接来传输的代码也出现类似问题

最终的解决方案都不是不要注释，而是创建区别于**开发版**的**发布版**代码，通常由专门对代码运行一次的工具完成，由它把注释全清除掉，作为构建过程的一部分。


##最佳注释量：

约每十条语句有一个注释，这样的密度时程序清晰度最高，比这小的注释密度会让代码难以理解，更多的注释也会导致同样效果。(2000)

如果熟练运用**伪代码编程法**，日久天长地你就会每几行有个注释。



