# 1. -Waf

<!-- TOC -->

- [1. -Waf](#1--waf)
- [2. Preface:](#2-preface)
- [3. Keyword : Waf](#3-keyword--waf)
    - [3.1. What](#31-what)
        - [3.1.1. ä»€ä¹ˆæ˜¯Waf?](#311-ä»€ä¹ˆæ˜¯waf)
        - [3.1.2. Wafä¸Firewallçš„åŒºåˆ«ï¼Ÿ](#312-wafä¸firewallçš„åŒºåˆ«)
        - [3.1.3. Wafçš„ä½œç”¨ï¼Ÿ](#313-wafçš„ä½œç”¨)
        - [3.1.4. Wafæœ‰å“ªäº›åˆ†ç±»ï¼Ÿ](#314-wafæœ‰å“ªäº›åˆ†ç±»)
        - [3.1.5. ä»€ä¹ˆæ˜¯è½¯ä»¶waf?](#315-ä»€ä¹ˆæ˜¯è½¯ä»¶waf)
        - [3.1.6. ä»€ä¹ˆæ˜¯ç¡¬ä»¶Wafï¼Ÿ](#316-ä»€ä¹ˆæ˜¯ç¡¬ä»¶waf)
        - [3.1.7. ä»€ä¹ˆæ˜¯äº‘Waf?](#317-ä»€ä¹ˆæ˜¯äº‘waf)
        - [3.1.8. æœ‰å“ªäº›è½¯ä»¶waf?](#318-æœ‰å“ªäº›è½¯ä»¶waf)
    - [3.2. Why](#32-why)
        - [3.2.1. ä¸ºä»€ä¹ˆè¦ç”¨ç¡¬ä»¶waf?](#321-ä¸ºä»€ä¹ˆè¦ç”¨ç¡¬ä»¶waf)
        - [3.2.2. ä¸ºä»€ä¹ˆè¦ç”¨è½¯ä»¶waf?](#322-ä¸ºä»€ä¹ˆè¦ç”¨è½¯ä»¶waf)
        - [3.2.3. ä¸ºä»€ä¹ˆè¦ç”¨äº‘Waf?](#323-ä¸ºä»€ä¹ˆè¦ç”¨äº‘waf)
    - [3.3. How](#33-how)
    - [3.4. When&Where&Who](#34-whenwherewho)
        - [3.4.1. ä»€ä¹ˆä¼ä¸šä¼šé€‰æ‹©ä»€ä¹ˆWafï¼Ÿ](#341-ä»€ä¹ˆä¼ä¸šä¼šé€‰æ‹©ä»€ä¹ˆwaf)
    - [3.5. History:](#35-history)
    - [3.6. ADEPT:](#36-adept)
        - [3.6.1. Analogy ç±»æ¯”ï¼šè¿™ä¸ªæ¦‚å¿µåƒæ˜¯ä»€ä¹ˆå·²çŸ¥çš„ä¸œè¥¿ï¼Ÿ](#361-analogy-ç±»æ¯”è¿™ä¸ªæ¦‚å¿µåƒæ˜¯ä»€ä¹ˆå·²çŸ¥çš„ä¸œè¥¿)
        - [3.6.2. Diagram å¯è§†åŒ–ï¼šæŠŠè¿™ä¸ªæ¦‚å¿µç”»å‡ºæ¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ](#362-diagram-å¯è§†åŒ–æŠŠè¿™ä¸ªæ¦‚å¿µç”»å‡ºæ¥æ˜¯ä»€ä¹ˆæ ·å­)
        - [3.6.3. Example å®ä¾‹ï¼šæœ‰ä»€ä¹ˆèº«è¾¹çš„æ¡ˆä¾‹ï¼Ÿ](#363-example-å®ä¾‹æœ‰ä»€ä¹ˆèº«è¾¹çš„æ¡ˆä¾‹)
        - [3.6.4. Plain English å¤§ç™½è¯è®²è§£ï¼šå¦‚ä½•å‘ä¸€ä¸ªå°å­©è®²è§£è¿™ä¸ªæ¦‚å¿µï¼Ÿ](#364-plain-english-å¤§ç™½è¯è®²è§£å¦‚ä½•å‘ä¸€ä¸ªå°å­©è®²è§£è¿™ä¸ªæ¦‚å¿µ)
        - [3.6.5. Technical Definitionï¼šçœŸæ­£ä¸“ä¸šçš„å®šä¹‰å’Œæè¿°æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ](#365-technical-definitionçœŸæ­£ä¸“ä¸šçš„å®šä¹‰å’Œæè¿°æ˜¯ä»€ä¹ˆæ ·çš„)
    - [3.7. Principle:](#37-principle)
        - [3.7.1. å®ƒçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ](#371-å®ƒçš„æœ¬è´¨æ˜¯ä»€ä¹ˆ)
        - [3.7.2. å®ƒçš„ç¬¬ä¸€åŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ](#372-å®ƒçš„ç¬¬ä¸€åŸåˆ™æ˜¯ä»€ä¹ˆ)
        - [3.7.3. å®ƒçš„çŸ¥è¯†ç»“æ„æ˜¯æ€æ ·çš„?](#373-å®ƒçš„çŸ¥è¯†ç»“æ„æ˜¯æ€æ ·çš„)
    - [3.8. expansion](#38-expansion)
    - [3.9. inspire](#39-inspire)
    - [3.10. refsï¼š](#310-refs)

<!-- /TOC -->


---

# 2. Preface:

å¯»æ‰¾ä¸€æ¬¾é€‚åˆçš„è½¯ä»¶Waf,so to clear ç›¸å…³çš„æ¦‚å¿µ

---

# 3. Keyword : Waf

## 3.1. What

### 3.1.1. ä»€ä¹ˆæ˜¯Waf?

A **web application firewall** (or WAF) filters, monitors, and blocks HTTP traffic to and from a web application. 


### 3.1.2. Wafä¸Firewallçš„åŒºåˆ«ï¼Ÿ

A WAF is differentiated from a regular firewall in that a WAF is able to filter the content of **specific web applications** while regular firewalls serve as a safety gate between **servers**. 

åŒºåˆ«åœ¨äºï¼š

web application firewallæ˜¯é’ˆå¯¹ç‰¹å®šçš„Webåº”ç”¨çš„ï¼Œè€Œfirewallæ˜¯é’ˆå¯¹æœåŠ¡å™¨serverçš„


> ä¸€ä¸ªWebåº”ç”¨å°±éœ€è¦ä¸€ä¸ªWaf?

### 3.1.3. Wafçš„ä½œç”¨ï¼Ÿ

By inspecting HTTP traffic, it can prevent attacks stemming from **web application security flaws**, such as SQL injection, cross-site scripting (XSS), file inclusion, and security misconfigurations.[1]

é˜²web app å¸¸è§æ”»å‡»ç±»å‹


### 3.1.4. Wafæœ‰å“ªäº›åˆ†ç±»ï¼Ÿ

- ç¡¬ä»¶Webé˜²ç«å¢™
- Webé˜²æŠ¤è½¯ä»¶
- äº‘Waf

### 3.1.5. ä»€ä¹ˆæ˜¯è½¯ä»¶waf?

è½¯ä»¶Wafåˆ™æ˜¯å®‰è£…åœ¨éœ€è¦é˜²æŠ¤çš„æœåŠ¡å™¨ä¸Š

å®ç°æ–¹å¼é€šå¸¸æ˜¯Waf**ç›‘å¬ç«¯å£**æˆ–ä»¥**Webå®¹å™¨æ‰©å±•æ–¹å¼**è¿›è¡Œè¯·æ±‚æ£€æµ‹å’Œé˜»æ–­ã€‚


### 3.1.6. ä»€ä¹ˆæ˜¯ç¡¬ä»¶Wafï¼Ÿ

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fw6pd7zodnj30pg08swin.jpg)

ç¡¬ä»¶Wafé€šå¸¸çš„å®‰è£…æ–¹å¼æ˜¯å°†Wafä¸²è¡Œéƒ¨ç½²åœ¨WebæœåŠ¡å™¨å‰ç«¯ï¼Œç”¨äºæ£€æµ‹ã€é˜»æ–­å¼‚å¸¸æµé‡ã€‚

å¸¸è§„ç¡¬ä»¶Wafçš„å®ç°æ–¹å¼æ˜¯é€šè¿‡**ä»£ç†æŠ€æœ¯**ä»£ç†æ¥è‡ªå¤–éƒ¨çš„æµé‡ï¼Œå¹¶å¯¹è¯·æ±‚åŒ…è¿›è¡Œè§£æï¼Œé€šè¿‡å®‰å…¨è§„åˆ™åº“çš„æ”»å‡»è§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æˆåŠŸåŒ¹é…è§„åˆ™åº“ä¸­çš„è§„åˆ™ï¼Œåˆ™è¯†åˆ«ä¸ºå¼‚å¸¸å¹¶è¿›è¡Œè¯·æ±‚é˜»æ–­ã€‚

### 3.1.7. ä»€ä¹ˆæ˜¯äº‘Waf?

äº‘Wafæ˜¯è¿‘å¹´æ¥éšç€äº‘è®¡ç®—çš„æ¨åŠ¨è¡ç”Ÿå‡ºæ¥çš„æ–°äº§å“ï¼Œäº‘WAFï¼Œä¹Ÿç§°**WEBåº”ç”¨é˜²ç«å¢™çš„äº‘æ¨¡å¼**ï¼Œè¿™ç§æ¨¡å¼è®©ç”¨æˆ·ä¸éœ€è¦åœ¨è‡ªå·±çš„ç½‘ç»œä¸­å®‰è£…è½¯ä»¶ç¨‹åºæˆ–éƒ¨ç½²ç¡¬ä»¶è®¾å¤‡ï¼Œå°±å¯ä»¥å¯¹ç½‘ç«™å®æ–½å®‰å…¨é˜²æŠ¤ï¼Œ

å®ƒçš„ä¸»è¦å®ç°æ–¹å¼æ˜¯åˆ©ç”¨**DNSæŠ€æœ¯**ï¼Œé€šè¿‡ç§»äº¤åŸŸåè§£ææƒæ¥å®ç°å®‰å…¨é˜²æŠ¤ã€‚ç”¨æˆ·çš„è¯·æ±‚é¦–å…ˆå‘é€åˆ°**äº‘ç«¯èŠ‚ç‚¹**è¿›è¡Œæ£€æµ‹ï¼Œå¦‚å­˜åœ¨å¼‚å¸¸è¯·æ±‚åˆ™è¿›è¡Œæ‹¦æˆªå¦åˆ™å°†è¯·æ±‚è½¬å‘è‡³çœŸå®æœåŠ¡å™¨ã€‚



### 3.1.8. æœ‰å“ªäº›è½¯ä»¶waf?


- [Apacheçš„ä¸€å—æ¨¡å—ModSecurity](http://www.modsecurity.org/projects/modsecurity)
- [ä¸ºPHPåº”ç”¨è®¾è®¡çš„WAFç³»ç»Ÿ](https://phpids.org)
- [é›†æˆåˆ°IISå¹³å°çš„ISAPIè¿‡æ»¤å™¨](http://msdn.microsoft.com/zh-cn/library/aa302368.aspx)   
- [WebKnight](http://www.aqtronix.com/WebKnight/Manual/WebKnight-Chinese.pdf)
- [é›†æˆåˆ°IISçš„è¿‡æ»¤å™¨](http://www.aqtronix.com/?PageID=99)

---

## 3.2. Why

### 3.2.1. ä¸ºä»€ä¹ˆè¦ç”¨ç¡¬ä»¶waf?

å³ç¡¬ä»¶wafçš„å¥½å¤„ï¼Ÿ

- **éƒ¨ç½²ç®€æ˜“ï¼Œå³æ’å³ç”¨**
  - ç¡¬ä»¶Wafåªéœ€ä¸²è”åˆ°äº¤æ¢æœºä¸Šï¼Œè¿›è¡Œç®€å•çš„é…ç½®åå³å¯å®ç°Webå®‰å…¨é˜²æŠ¤
- **å¯æ‰¿å—è¾ƒé«˜çš„ååé‡**
  - ç”±äºç¡¬ä»¶é˜²ç«å¢™åŸºäºç¡¬ä»¶è®¾å¤‡å®ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯æ‰¿å—è¾ƒé«˜çš„æ•°æ®ååé‡
- **é˜²æŠ¤èŒƒå›´å¤§**
  - ç”±äºç¡¬ä»¶é˜²ç«å¢™ç›´æ¥ä¸²è”åˆ°äº†äº¤æ¢æœºï¼Œæ‰€ä»¥åœ¨åŒä¸€ä¸ªäº¤æ¢æœºä¸‹çš„æ‰€æœ‰æœåŠ¡å™¨ï¼Œéƒ½å¤„äºé˜²ç«å¢™çš„é˜²æŠ¤èŒƒå›´ä¹‹ç±»

é‚£å®ƒçš„å¼Šç«¯æ˜¯ï¼Ÿ

- **ä»·æ ¼æ˜‚è´µ**
  - ç›®å‰å®‰å…¨è¡Œä¸šä¸­çš„ç¡¬ä»¶Wafï¼Œä»·æ ¼å¯¹äºä¸­å°ä¼ä¸šæ¥è¯´è¿‡äºæ˜‚è´µï¼ŒåŠ¨è¾„ä¾¿æ˜¯å‡ åä¸‡ç”šè‡³å‡ ç™¾ä¸‡

- **å­˜åœ¨ä¸€å®šè¯¯æ€**
  - ç”±äºç¡¬ä»¶Wafæ˜¯é€šè¿‡æ”»å‡»è§„åˆ™åº“å¯¹å¼‚å¸¸æµé‡è¿›è¡Œè¯†åˆ«ï¼Œæ‰€ä»¥åœ¨ä¸šåŠ¡ç³»ç»Ÿå¤æ‚çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å­˜åœ¨ä¸€å®šè¯¯æ€å¯¼è‡´æ­£å¸¸åŠŸèƒ½è¢«é˜²ç«å¢™æ‹¦æˆªå¯¼è‡´å½±å“æ­£å¸¸ä¸šåŠ¡

- **å­˜åœ¨ä¸€å®šç»•è¿‡å‡ ç‡**
  - ç¡¬ä»¶é˜²ç«å¢™å¯¹HTTPåè®®è¿›è¡Œè‡ªè¡Œè§£æï¼Œå¯èƒ½å­˜åœ¨ä¸WebæœåŠ¡å™¨å¯¹HTTPè¯·æ±‚çš„ç†è§£ä¸ä¸€è‡´ä»è€Œå¯¼è‡´è¢«ç»•è¿‡

---

### 3.2.2. ä¸ºä»€ä¹ˆè¦ç”¨è½¯ä»¶waf?

å³è½¯ä»¶wafçš„å¥½å¤„ï¼Ÿ

- **å¼€ç®±å³ç”¨ï¼Œå»‰ä»·ç”šè‡³å…è´¹**
  - ç›®å‰å›½å†…çš„è½¯ä»¶Wafï¼Œå¦‚å®‰å…¨ç‹—ã€ç½‘ç«™å®‰å…¨å«å£«ç­‰çš†æœ‰å…è´¹ç‰ˆï¼Œä¸‹è½½å®‰è£…åç®€å•é…ç½®å³å¯ä½¿ç”¨ã€‚

- **ç®¡ç†æ–¹ä¾¿ï¼Œç•Œé¢å‹å¥½**
  - ç›®å‰è¡Œä¸šä¸­çš„è½¯ä»¶Wafæä¾›å‹å¥½çš„æŸ¥çœ‹ã€ç®¡ç†ç•Œé¢ï¼Œä½¿å¾—å³ä½¿æ˜¯éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½é€šè¿‡è½¯ä»¶ç®¡ç†æœåŠ¡å™¨çš„å®‰å®‰å…¨çŠ¶æ€

- **åŠŸèƒ½ä¸°å¯Œ**
  - ä½¿ç”¨è½¯ä»¶å®ç°çš„Wafé™¤äº†å®ç°å¯¹Webåº”ç”¨çš„é˜²æŠ¤åŠŸèƒ½ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–ä¸°å¯Œçš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æ‰«ææ¶æ„æœ¨é©¬æ–‡ä»¶ã€é˜²ç¯¡æ”¹ã€æœåŠ¡å™¨ä¼˜åŒ–ã€å¤‡ä»½ç­‰ç­‰åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å¯¹äºä¸äº†è§£ç½‘ç«™æŠ€æœ¯çš„äººæ¥è¯´æä¾›äº†ä¾¿æ·

é‚£å®ƒçš„å¼Šç«¯æ˜¯ï¼Ÿ

- **è¯¯æ€&æ¼æŠ¥ç‰¹æ€§**
  - è½¯ä»¶Waf**å¯¹HTTPåè®®å®ç°äº†è‡ªè§£æ**ï¼Œæ— æ³•å’Œå®¹å™¨èƒŒåçš„Webåº”ç”¨ä¿æŒå¯¹åè®®çš„ç†è§£ä¸€è‡´ï¼Œåœ¨è¯¯æ€å’Œæ¼æŠ¥ä¹‹é—´ä¸èƒ½å¾ˆå¥½çš„å¹³è¡¡ï¼Œè§£æå¤ªè¿‡ç»†åŒ–åˆå­˜åœ¨Wafå¯è½»æ˜“è¢«æ¬ºéª—å¯¼è‡´ç»•è¿‡çš„ç‰¹ç‚¹ï¼Œé˜²å¾¡å¤ªè¿‡ä¸¥è°¨åˆå¯èƒ½ä¼šå¯¼è‡´å½±å“æ­£å¸¸ä¸šåŠ¡è¿è¡Œ

- **å ç”¨å†…å­˜è¿‡å¤š**
  - ç”±äºè½¯ä»¶Wafè¦å®ç°å¯¹æ¯ä¸ªè¯·æ±‚çš„è§£æã€è¯†åˆ«ï¼Œå¯èƒ½ä¼šå­˜åœ¨å ç”¨æœåŠ¡å™¨å†…å­˜è¿‡å¤šçš„æƒ…å†µ

- **åªé€‚åˆä¸­å°å‹ç½‘ç«™**
  - ç”±äºè½¯ä»¶Waféœ€è¦å•å°æœåŠ¡å™¨éƒ¨ç½²ï¼Œå¹¶ä¸”å¯èƒ½å­˜åœ¨å½±å“æ­£å¸¸ä¸šåŠ¡çš„é£é™©å’Œè¢«ç»•è¿‡çš„é£é™©ï¼Œä¸é€‚åˆå¤§å‹çš„ç½‘ç»œçš„å®‰å…¨é˜²æŠ¤ä½¿ç”¨

---

### 3.2.3. ä¸ºä»€ä¹ˆè¦ç”¨äº‘Waf?

å³äº‘Wafçš„å¥½å¤„ï¼Ÿ

- **éƒ¨ç½²ç®€å•ï¼Œç»´æŠ¤æˆæœ¬ä½**
  - è¿™ä¹Ÿæ˜¯äº‘Wafæœ€æœ‰ä»·å€¼å’Œå—ç”¨æˆ·å–œçˆ±çš„ä¸€ç‚¹ï¼Œæ— éœ€å®‰è£…ä»»ä½•è½¯ä»¶æˆ–è€…éƒ¨ç½²ä»»ä½•ç¡¬ä»¶è®¾å¤‡ï¼Œåªéœ€ä¿®æ”¹DNSå³å¯å°†ç½‘ç«™éƒ¨ç½²åˆ°äº‘Wafçš„é˜²æŠ¤èŒƒå›´ä¹‹å†…

- **ç”¨æˆ·æ— éœ€æ›´æ–°**
  - äº‘Wafçš„é˜²æŠ¤è§„åˆ™éƒ½å¤„äºäº‘ç«¯ï¼Œæ–°æ¼æ´çˆ†å‘æ—¶ï¼Œç”±äº‘ç«¯è´Ÿè´£è§„åˆ™çš„æ›´æ–°å’Œç»´æŠ¤ï¼Œç”¨æˆ·æ— éœ€æ‹…å¿ƒå› ä¸ºç–å¿½å¯¼è‡´å—åˆ°æ–°å‹çš„æ¼æ´æ”»å‡»

- **å¯å……å½“CDN**
  - äº‘Wafåœ¨æä¾›é˜²æŠ¤åŠŸèƒ½çš„åŒæ—¶ï¼Œè¿˜åŒæ—¶å…·æœ‰CDNçš„åŠŸèƒ½ï¼Œåœ¨è¿›è¡Œé˜²æŠ¤çš„åŒæ—¶è¿˜å¯ä»¥æé«˜ç½‘ç«™è®¿é—®çš„é€Ÿç‡ï¼ŒCDNé€šè¿‡è·¨è¿è¥å•†çš„å¤šçº¿æ™ºèƒ½è§£æè°ƒåº¦å°†é™æ€èµ„æºåŠ¨æ€è´Ÿè½½åˆ°å…¨å›½çš„äº‘èŠ‚ç‚¹ï¼Œç”¨æˆ·è®¿é—®æŸä¸ªèµ„æºæ—¶ä¼šè¢«å¼•å¯¼è‡³æœ€è¿‘çš„äº‘ç«¯èŠ‚ç‚¹ä»è€Œæé«˜è®¿é—®é€Ÿåº¦


é‚£å®ƒçš„å¼Šç«¯æ˜¯ï¼Ÿ

- **å­˜åœ¨è½»æ˜“è¢«ç»•è¿‡çš„é£é™©**
  - äº‘Wafçš„ä¸»è¦å®ç°åŸç†æ˜¯é€šè¿‡å°†ç”¨æˆ·çš„DNSè§£æåˆ°äº‘èŠ‚ç‚¹å®ç°é˜²æŠ¤ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¦‚æœé»‘å®¢é€šè¿‡ç›¸å…³æ‰‹æ®µè·å–äº†æœåŠ¡å™¨çš„çœŸå®IPåœ°å€ï¼Œç„¶åå¼ºåˆ¶è§£æåŸŸåï¼Œå°±å¯ä»¥è½»æ¾ç»•è¿‡äº‘Wafå¯¹æœåŠ¡å™¨å‘èµ·æ”»å‡»

- **å¯é æ€§ä½**
  - äº‘Wafå¤„ç†ä¸€æ¬¡è¯·æ±‚ï¼Œå…¶ä¸­éœ€è¦ç»è¿‡DNSè§£æã€è¯·æ±‚è°ƒåº¦ã€æµé‡è¿‡æ»¤ç­‰ç¯èŠ‚ï¼Œå…¶ä¸­æ¶‰åŠååŒå…³è”å·¥ä½œï¼Œå…¶ä¸­åªè¦æœ‰ä¸€ä¸ªç¯èŠ‚å‡ºç°é—®é¢˜ï¼Œå°±ä¼šå¯¼è‡´ç½‘ç«™æ— æ³•è®¿é—®ã€‚å¿…è¦æ—¶ï¼Œåªèƒ½æ‰‹åŠ¨åˆ‡æ¢ä¸ºåŸDNSæ¥ä¿è¯ä¸šåŠ¡æ­£å¸¸è¿è¡Œï¼Œè€ŒåŸŸåè§£æéœ€è¦ä¸€å®šæ—¶é—´ï¼Œåˆ™ä¼šå¯¼è‡´ç½‘ç«™çŸ­æ—¶é—´æ— æ³•æ­£å¸¸è®¿é—®

- **ä¿å¯†æ€§ä½**
  - ç½‘ç«™è®¿é—®æ•°æ®å¯¹äºä¸€äº›ä¼ä¸šã€æœºæ„æ¥è¯´ä¸ºä¿å¯†æ•°æ®ï¼Œé‡Œé¢å¯èƒ½åŒ…å«ç”¨æˆ·çš„éšç§æˆ–è€…å•†ä¸šä¿¡æ¯ï¼Œè¿™äº›æ•°æ®è‡ªè¡Œç®¡æ§ä¼šç›¸å¯¹å®‰å…¨ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨Wafï¼Œæ‰€æœ‰çš„æ•°æ®ä¼šè®°å½•åˆ°äº‘ç«¯ï¼Œè¿™ç›¸å½“äºæ•°æ®è¢«åˆ«äººä¿ç®¡ï¼Œå¯èƒ½å­˜åœ¨ä¸€å®šçš„æ³„éœ²é£é™©


---

## 3.3. How

---

## 3.4. When&Where&Who

### 3.4.1. ä»€ä¹ˆä¼ä¸šä¼šé€‰æ‹©ä»€ä¹ˆWafï¼Ÿ

å¹¿å¤§ç½‘ç«™ç®¡ç†è€…ï¼Œéœ€è¦æ ¹æ®è‡ªèº«å®é™…æƒ…å†µæ¥é€‰æ‹©åˆé€‚çš„å®‰å…¨äº§å“å’ŒæœåŠ¡

- ç¡¬ä»¶Waf:
  - å¤§å‹ä¼ä¸šorå®‰å…¨éœ€æ±‚è¾ƒé«˜çš„ç½‘ç«™ï¼Œå¦‚æ”¿åºœã€é‡‘èã€è¿è¥å•†

- è½¯Waf:
  - å°å‹ä¼ä¸šorå›¢é˜Ÿ

- äº‘waf:
  - å®‰å…¨éœ€æ±‚è¾ƒä½çš„ä¸­å°å‹ä¼ä¸šæˆ–è€…ä¸ªäººç½‘ç«™

---

## 3.5. History:

Application firewalls, which control input, output, and access from applications or services, were first developed in the early 1990s by Gene Spafford, Bill Cheswick, and Marcus Ranum.

> 90å¹´ä»£å°±æœ‰è¿™ä¸ªApplication firewallsäº†ã€‚

Their product was largely a network-based firewall but could handle a few applications (like FTP or RSH) and was released to market by DEC. 

Within the next few years, the products were further developed by other researchers to provide stable firewall software for others to build on, and raised the bar for the industry.

Dedicated web application firewalls entered the market later in the decade when web server hacker attacks were becoming much more noticeable.

The first company to offer a dedicated web application firewall was **Perfecto Technologies** with its **AppShield** product, which focused on the **e-commerce market** and protected against illegal web page character entries. 

> ç”µå•†é¢‘ç¹æ¶‰åŠåˆ°äº¤æ˜“,äº¤æ˜“å½“ä¸­çš„é’±æœ€é‡è¦å‘€,æ˜¯ç—›ç‚¹ã€‚

Perfecto renamed itself as Sanctum and named the top ten web application hacking techniques and laid the foundations for the WAF market:

- Hidden field manipulation
- Cookie poisoning
- Parameter tampering[5]
- Buffer overflow
- Cross Site Scripting (XSS)
- Backdoor or Debug options
- Stealth commanding
- Forced browsing[6]
- Third party misconfigurations[7]
- Known vulnerabilities

In 2002, the open source project **ModSecurity** was formed in order to make WAF technology more accessible and solve the obstacles within the industry like business cases, cost barriers, and proprietary rule-sets. 

> ModSecurity å±…ç„¶æ˜¯æœ€æ—©çš„å¼€æºwaf~ ğŸ‚ ğŸº

ModSecurity finalized a core rule set for protecting Web Applications, based on the OASIS Web Application Security Technical Committeeâ€™s (WAS TC) vulnerability work. In 2003, their work was expanded and standardized through the Open Web Application Security Projectâ€™s (OWASP) Top 10 List, an annual ranking for web security vulnerabilities. This list would become the industry benchmark for many compliance themes.

Since then, the market has continued to grow and evolve, involving the larger commerce industry with the rise in credit card fraud. With the development of Payment Card Industry Data Security Standard (PCI DSS), a standard for organizations to increase controls on cardholder data, security is more regulated and has sparked wide-scale interest in the industry. According to CISO Magazine, the WAF market size was expected to grow to $5.48 billion by 2022.[11]

(æ¥è‡ªwiki)

----

## 3.6. ADEPT:

### 3.6.1. Analogy ç±»æ¯”ï¼šè¿™ä¸ªæ¦‚å¿µåƒæ˜¯ä»€ä¹ˆå·²çŸ¥çš„ä¸œè¥¿ï¼Ÿ

åƒå¨æˆ¿é‡Œçš„è¿‡æ»¤å™¨filterï¼Œè¿‡æ»¤æ‰å¤§å—çš„æ®‹ä½™æ¸£æ»“ã€‚

å¨æˆ¿çš„filterçš„è¿‡æ»¤æ˜¯æ ¹æ®ç‰©å—çš„å¤§å°,å¦‚æœç‰©å—çš„ä½“ç§¯å¤§äºå­”çš„å¤§å°,å°±æ— æ³•é€šè¿‡ã€‚

![](https://ws1.sinaimg.cn/large/006tNbRwgy1fw6pus7kiuj30gg0f0wlr.jpg)

è€ŒWafçš„è¿‡æ»¤çš„ä¾æ®ä¹‹ä¸€æ˜¯åŸºäºè§„åˆ™ï¼Œå¦‚æœattackerçš„attack vector(æ”»å‡»å‘é‡)hitä¸­è§„åˆ™çš„è¯,é‚£ä¹ˆå®ƒå°±æ— æ³•é€šè¿‡ã€‚

![](https://ws4.sinaimg.cn/large/006tNbRwgy1fw6puxrf0ij31j60iw0z7.jpg)




### 3.6.2. Diagram å¯è§†åŒ–ï¼šæŠŠè¿™ä¸ªæ¦‚å¿µç”»å‡ºæ¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ

![](https://ws1.sinaimg.cn/large/006tNbRwgy1fw6pbxiwftj31ho15ghdt.jpg)

### 3.6.3. Example å®ä¾‹ï¼šæœ‰ä»€ä¹ˆèº«è¾¹çš„æ¡ˆä¾‹ï¼Ÿ

ä¸€ä¸ªå°å‹ä¼ä¸šé€‰ç”¨äº†è½¯Wafæ¥è¿‡ç­‰ä¿ã€‚ä¼¼ä¹è¿™è½¯wafé›†æˆåˆ°å®ƒçš„web appé‡Œé¢å»,ç›¸å½“äºæˆäº†ä¸€ä¸ªæ–°çš„componentã€‚

åœ¨å¤–ç•Œé»‘ç›’çš„è§†è§’çœ‹æ¥,æ˜¯ä¸çŸ¥é“ä½ è£…äº†è½¯wafçš„ã€‚ä¸åƒæ˜¯ç¡¬ä»¶Waf,æœ‰ç€å®ä½“çš„å­˜åœ¨

### 3.6.4. Plain English å¤§ç™½è¯è®²è§£ï¼šå¦‚ä½•å‘ä¸€ä¸ªå°å­©è®²è§£è¿™ä¸ªæ¦‚å¿µï¼Ÿ

ä¸ŠWafçš„ä½œç”¨æœ‰ç‚¹åƒé¢„é˜²é’ˆçš„ä½œç”¨,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¤§æ¦‚ç‡é˜²èŒƒä½ çš„èº«ä½“ä¸ç”Ÿç—…,ä½†æ˜¯ä¸èƒ½ç»å¯¹ä¿è¯ä½ çš„èº«ä½“æ°¸ä¸ç”Ÿç—…å‘€ã€‚

å› ä¸ºå¦‚æœæœ‰æ–°çš„ç—…åŸä½“(attack vector),è¶…å‡ºäº†åŸæ¥é¢„é˜²é’ˆçš„ä¿æŠ¤èŒƒå›´ï¼Œé‚£ä¹ˆä½ çš„èº«ä½“(Web app)ä¹Ÿä¼šç”Ÿç—…çš„ã€‚

ä¸ŠWafç¡®å®å¯ä»¥å¸®Web app æå‰é˜²èŒƒå¤§å¤šæ•°"ç®€å•çš„åŸºç¡€"çš„â€œç–¾ç—…â€ã€‚è¿™æ˜¯ç›¸å¯¹çš„è¯´æ³•,å› ä¸ºå¤§å¤šæ•°å‚å•†çš„Wafå¯¹äºæ™®é€šçš„attackeræ¥ä¹¦è¿˜æ˜¯éå¸¸éš¾ä»¥ç»•è¿‡çš„ã€‚å› ä¸ºå‚å•†çš„wafè§„åˆ™ä¼šæ›´æ–°,è€Œä¸”ç°åœ¨è¿˜åŠ äº†å¾ˆå¤šä¸åŸºäºè§„åˆ™çš„æ–¹æ³•ã€‚


### 3.6.5. Technical Definitionï¼šçœŸæ­£ä¸“ä¸šçš„å®šä¹‰å’Œæè¿°æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ

A web application firewall (or WAF) filters, monitors, and blocks HTTP traffic to and from a web application.

---

## 3.7. Principle:

### 3.7.1. å®ƒçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

ä¸€ä¸ªå¯ä»¥blocks HTTP trafficçš„filterã€‚
ç±»ä¼¼äº¤é€šç®¡åˆ¶ä¸€æ ·ã€‚

### 3.7.2. å®ƒçš„ç¬¬ä¸€åŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

ä¿éšœWeb appå®‰å…¨ã€‚

### 3.7.3. å®ƒçš„çŸ¥è¯†ç»“æ„æ˜¯æ€æ ·çš„?


---

## 3.8. expansion

- Firewall

---

## 3.9. inspire



----

## 3.10. refsï¼š

- [Web application firewall](https://en.wikipedia.org/wiki/Web_application_firewall)
- [æµ…æWafä¼˜ç¼ºç‚¹||ç¡¬ä»¶Wafã€è½¯ä»¶Wafã€äº‘Wafä¹‹æ€»ç»“](https://zhuanlan.zhihu.com/p/27889038)
- [WAFï¼šç¶²ç«™ä¸»æ©Ÿçš„é‡‘é˜ç½©éµå¸ƒè¡«](https://www.techbang.com/posts/1826-waf-web-host-bridge-is-falling-down)
